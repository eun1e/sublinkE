import{d as e,r as a,o as l,C as t,c as o,e as i,Z as s,w as u,l as r,a2 as n,g as p,t as m,ay as v,W as c,aH as d,a0 as f,a1 as g,aN as y,aO as _}from"./index.CBDW5MZN.js";import{E as j}from"./el-card.BDQYTqej.js";import{E as x,a as C,b as h}from"./el-table-column.pp57FS8X.js";import{E as w}from"./el-tag.BJkdW0pt.js";import"./el-select.DMpViTnG.js";import"./el-scrollbar.z2K0iAz0.js";import"./el-popper.BGmmqjsP.js";import"./el-tooltip.l0sNRNKZ.js";import{E as b}from"./el-dialog.Bl0sxCrq.js";import{g as k,A as V,U as z,D as E}from"./temp.Cloe9xl6.js";import{_ as U}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./isEqual.NdnOIZWa.js";import"./_initCloneObject.C-kpAzhc.js";import"./debounce.BGyIsUNQ.js";import"./index.bK8ebiFb.js";import"./strings.q87tCy6s.js";import"./isUndefined.DgmxjSXK.js";import"./use-dialog.BgkYRpD0.js";import"./refs.BcQWbdHY.js";const T=e=>(y("data-v-8a18272d"),e=e(),_(),e),B={class:"dialog-footer"},O=T((()=>r("div",{style:{"margin-bottom":"10px"}},null,-1))),S=T((()=>r("div",{style:{"margin-top":"20px"}},null,-1))),D=T((()=>r("div",{style:{"margin-top":"20px"}},null,-1))),H=U(e({__name:"template",setup(e){const y=a([]),_=a(""),U=a(""),T=a(""),H=a(!1),I=a(),A=a(""),K=a("1");async function N(){const{data:e}=await k();y.value=e}l((async()=>{N()}));const R=()=>{A.value="添加模版",U.value="",T.value="",K.value="1",H.value=!0},q=async()=>{"添加模版"==A.value?(await V({filename:U.value.trim(),text:T.value.trim()}),v.success("添加成功")):(await z({filename:U.value.trim(),oldname:_.value.trim(),text:T.value.trim()}),v.success("更新成功")),N(),U.value="",T.value="",H.value=!1},F=a([]),J=e=>{F.value=e},M=()=>{0!==F.value.length&&d.confirm("你是否要删除选中这些 ?","提示",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then((()=>{for(let e=0;e<F.value.length;e++)E({filename:F.value[e].file}),y.value=y.value.filter((a=>a.file!==F.value[e].file));v({type:"success",message:"删除成功"})}))},P=a(1),W=a(10),Z=e=>{W.value=e},$=e=>{P.value=e},G=t((()=>{const e=(P.value-1)*W.value,a=e+W.value;return y.value.slice(e,a)}));return(e,a)=>{const l=f,t=g,k=b,V=x,z=w,K=C,F=h,L=j;return o(),i("div",null,[s(k,{modelValue:H.value,"onUpdate:modelValue":a[3]||(a[3]=e=>H.value=e),title:A.value,width:"80%"},{footer:u((()=>[r("div",B,[s(t,{onClick:a[2]||(a[2]=e=>H.value=!1)},{default:u((()=>[n("关闭")])),_:1}),s(t,{type:"primary",onClick:q},{default:u((()=>[n("确定")])),_:1})])])),default:u((()=>[s(l,{modelValue:T.value,"onUpdate:modelValue":a[0]||(a[0]=e=>T.value=e),placeholder:"模版内容",rows:10,type:"textarea",style:{"margin-bottom":"10px"}},null,8,["modelValue"]),s(l,{modelValue:U.value,"onUpdate:modelValue":a[1]||(a[1]=e=>U.value=e),placeholder:"模版文件名"},null,8,["modelValue"])])),_:1},8,["modelValue","title"]),s(L,null,{default:u((()=>[s(t,{type:"primary",onClick:R},{default:u((()=>[n("添加模版")])),_:1}),O,s(K,{ref_key:"table",ref:I,data:p(G),style:{width:"100%"},onSelectionChange:J},{default:u((()=>[s(V,{type:"selection",fixed:"",prop:"ID",label:"id"}),s(V,{prop:"file",label:"模版文件名"},{default:u((e=>[s(z,{type:"success"},{default:u((()=>[n(m(e.row.file),1)])),_:2},1024)])),_:1}),s(V,{prop:"create_date",label:"创建时间",sortable:""}),s(V,{fixed:"right",label:"操作",width:"120"},{default:u((e=>[s(t,{link:"",type:"primary",size:"small",onClick:a=>(e=>{for(let a=0;a<y.value.length;a++)y.value[a].file===e.file&&(A.value="编辑模版",U.value=y.value[a].file,_.value=U.value,T.value=y.value[a].text,H.value=!0)})(e.row)},{default:u((()=>[n("编辑")])),_:2},1032,["onClick"]),s(t,{link:"",type:"primary",size:"small",onClick:a=>{return l=e.row,void d.confirm(`你是否要删除 ${l.file} ?`,"提示",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then((async()=>{await E({filename:l.file,type:l.type}),v({type:"success",message:"删除成功"}),N()}));var l}},{default:u((()=>[n("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),S,s(t,{type:"info",onClick:a[4]||(a[4]=e=>{c((()=>{y.value.forEach((e=>{I.value.toggleRowSelection(e,!0)}))}))})},{default:u((()=>[n("全选")])),_:1}),s(t,{type:"warning",onClick:a[5]||(a[5]=e=>{I.value.clearSelection()})},{default:u((()=>[n("取消选择")])),_:1}),s(t,{type:"danger",onClick:M},{default:u((()=>[n("批量删除")])),_:1}),D,s(F,{onSizeChange:Z,onCurrentChange:$,"current-page":P.value,"page-size":W.value,layout:"total, sizes, prev, pager, next, jumper","page-sizes":[10,20,30,40],total:y.value.length},null,8,["current-page","page-size","total"])])),_:1})])}}}),[["__scopeId","data-v-8a18272d"]]);export{H as default};
